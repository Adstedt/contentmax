# Story 01.05: Product Table View

## Status

Draft

## Story

**As a** content manager reviewing large product catalogs,
**I want** to switch between card and table views for products,
**so that** I can scan through many products efficiently and compare data at a glance without scrolling through cards.

## Acceptance Criteria

### Functional Requirements:

1. **View Toggle Controls**
   - Toggle button group in product section header: `[Cards] [Table]`
   - Icon-based toggles: Card icon (grid) | Table icon (rows)
   - Active view highlighted with brand color (`bg-[#10a37f]`)
   - Persists view preference in localStorage
   - Position: Next to sort/filter controls

2. **Table View Layout**
   - Compact table displaying products in rows
   - Columns (left to right):
     - **Thumbnail** (40x40px, fixed width)
     - **Title** (flexible, truncated with ellipsis)
     - **Labels** (pill badges, max 2 visible + count)
     - **Brand** (100px width, truncated)
     - **Price** (80px width, right-aligned)
     - **Status** (icon + text, 100px width)
     - **ID** (90px width, monospace font)
     - **Assigned** (avatar, 40px width, centered)
     - **Actions** (Details button + three-dot menu, 100px width)

3. **Table Interactions**
   - Click row → Open ProductDetailModal (same as card click)
   - Click Details → Open ProductDetailModal (same as card button)
   - Hover row → Subtle highlight (`hover:bg-white/5`)
   - Click three-dot menu → Show action menu (future: labels, assign, etc.)
   - Selected row indicator (when sidebar product selected)

4. **Table Header**
   - Column headers with labels
   - Sortable columns (Title, Brand, Price, Status, ID)
   - Click header → Sort by that column
   - Visual sort indicator: ↑ ↓ arrows
   - Header sticky on scroll

5. **Responsive Behavior**
   - Hide less important columns on smaller screens:
     - Mobile (< 640px): Show only Thumbnail, Title, Price, Actions
     - Tablet (640-1024px): Add Brand, Status
     - Desktop (> 1024px): Show all columns
   - Horizontal scroll on very small screens

6. **Empty States**
   - "No products found" message in table
   - Maintains table structure (shows headers)
   - Helpful text: "Try adjusting your filters"

### Design System Consistency:

7. **Visual Design**
   - Dark theme matching existing UI (`bg-[#0a0a0a]` table, `bg-[#1a1a1a]` rows)
   - Border colors: `border-[#2a2a2a]`
   - Text hierarchy: White titles, gray-400 metadata
   - Row height: 60px (comfortable scanning)
   - Zebra striping optional: Subtle `bg-[#0f0f0f]` for odd rows

8. **Typography**
   - Title: `text-sm font-semibold text-white`
   - Metadata: `text-xs text-gray-400`
   - Price: `text-sm font-bold text-[#10a37f]`
   - ID: `text-xs font-mono text-gray-500`

9. **Component Reuse**
   - Reuse existing label badges from SimpleProductCard
   - Reuse status icons and colors
   - Reuse avatar component
   - Reuse three-dot menu button

### Integration Requirements:

10. **State Management**

    ```typescript
    const [productView, setProductView] = useState<'cards' | 'table'>('cards');

    // Persist preference
    useEffect(() => {
      const saved = localStorage.getItem('productViewPreference');
      if (saved) setProductView(saved as 'cards' | 'table');
    }, []);

    useEffect(() => {
      localStorage.setItem('productViewPreference', productView);
    }, [productView]);
    ```

11. **Sorting Integration**
    - Table column sorts use existing `productSortBy` state
    - Clicking column header updates existing sort state
    - Works seamlessly with existing filter/sort logic
    - Add new sort options if needed: `id`, `status`, `brand`

12. **Filter Integration**
    - Table view respects all existing filters:
      - Search query
      - Price range
      - Brand selection
      - Availability status
    - Filter controls remain visible above table
    - Product count updates: "Showing 50 of 127 products"

### Performance Considerations:

13. **Virtual Scrolling (Future Enhancement)**
    - For 500+ products, implement virtual scrolling
    - Only render visible rows in viewport
    - Library recommendation: `react-virtual` or `tanstack/virtual`
    - Phase 2 optimization if needed

14. **Initial Implementation**
    - Start with full render (acceptable for < 200 products)
    - Add loading skeleton for table rows
    - Lazy load images in thumbnails

## Design Reference

### Table Structure:

```
┌────────────────────────────────────────────────────────────────────────────────┐
│ [Thumbnail] │ Title              │ Labels  │ Brand │ Price  │ Status │ ID  │👤│⋮│
├────────────────────────────────────────────────────────────────────────────────┤
│ [🖼️]       │ Ballograf Epoca... │ [New]   │ Ballo │ $48.75 │✓ Stock │ 89..│JD│⋮│
│ [🖼️]       │ Kulepenna Rondo... │ [Sale]  │ Ballo │ $37.50 │✓ Stock │ 12..│JD│⋮│
│ [🖼️]       │ Parker Jotter M... │         │ Parker│ $23.00 │⚠ Low  │ 45..│JD│⋮│
└────────────────────────────────────────────────────────────────────────────────┘
```

### View Toggle UI:

```
Products (127)                    [🔍 Search] [↕️ Sort] [🎛️ Filter]  [■■ Cards] [☰ Table]
```

## Alternative Approaches

### Density Options:

- **Comfortable** (60px rows) - Default
- **Compact** (40px rows) - More products visible
- Add density toggle: `[Comfortable ▼]`

### Column Customization (Future):

- User can show/hide columns
- Drag to reorder columns
- Save column preferences

### Bulk Actions (Future):

- Checkboxes in first column
- Select multiple products
- Bulk assign, bulk label, bulk export

## Technical Notes

### Files to Create:

- `components/taxonomy/ProductTableView.tsx` - New table component
- `components/taxonomy/ProductTableRow.tsx` - Individual row component

### Files to Modify:

- `components/taxonomy/TaxonomyVisualization.tsx` - Add view toggle, conditional render

### Component Structure:

```typescript
interface ProductTableViewProps {
  products: Product[];
  onProductSelect: (product: Product) => void;
  onDetailsClick: (product: Product) => void;
  selectedProduct: Product | null;
  sortBy: ProductSortBy;
  onSortChange: (sort: ProductSortBy) => void;
}
```

### Accessibility:

- Semantic `<table>` element
- ARIA labels for sortable headers
- Keyboard navigation (arrow keys between rows)
- Focus visible indicators
- Screen reader announcements for sort changes

## Dependencies

- No new npm packages required for initial implementation
- Future: `@tanstack/react-virtual` for virtual scrolling (if needed)

## Dev Notes

- Table should scroll independently if content is taller than viewport
- Consider fixed table header on scroll (sticky)
- Three-dot menu actions are mocked for now (same as cards)
- Ensure table is responsive - critical for usability

## Testing

### Unit Tests:

- [ ] Toggle between card and table views
- [ ] View preference persists in localStorage
- [ ] Clicking row opens ProductDetailModal
- [ ] Column sorting updates productSortBy state
- [ ] Filters apply correctly to table view

### Integration Tests:

- [ ] Switch views maintains selected product
- [ ] Sort in table view updates card view sort
- [ ] Search/filter works in both views
- [ ] Selected row highlights correctly

### Manual Tests:

- [ ] Test with 10, 50, 200+ products
- [ ] Verify responsive behavior on mobile/tablet
- [ ] Check accessibility (keyboard navigation, screen reader)
- [ ] Verify performance with large datasets
- [ ] Test empty states and loading states

### Visual Regression:

- [ ] Table styling matches design system
- [ ] Dark theme consistency
- [ ] Row hover states
- [ ] Column alignment (left/right/center)

## Tasks

### Phase 1: Basic Table View

- [ ] Create ProductTableView component
- [ ] Create ProductTableRow component
- [ ] Add view toggle button in TaxonomyVisualization
- [ ] Implement localStorage persistence
- [ ] Basic table layout with all columns
- [ ] Row click opens modal

### Phase 2: Sorting & Interaction

- [ ] Add sortable column headers
- [ ] Implement click-to-sort functionality
- [ ] Add sort direction indicators (↑↓)
- [ ] Hover states and selected row highlight
- [ ] Three-dot menu button

### Phase 3: Responsive & Polish

- [ ] Implement responsive column hiding
- [ ] Sticky table header
- [ ] Loading skeleton for table rows
- [ ] Empty state messaging
- [ ] Accessibility improvements

### Phase 4: Optimization (If Needed)

- [ ] Add virtual scrolling for 500+ products
- [ ] Optimize thumbnail loading
- [ ] Performance profiling

## User Benefits

### Problem Solved:

- **Current:** Scrolling through 50+ product cards is overwhelming
- **Solution:** Table view shows more products per screen (3-4x more)
- **Result:** Faster scanning, easier comparison, less scrolling

### Use Cases:

1. **Data Review:** Quickly scan prices, brands, status across many products
2. **Comparison:** Compare products side-by-side in compact format
3. **Bulk Operations:** Easier to process large catalogs (future: bulk actions)
4. **Data Export Preparation:** Table format is familiar for data-focused tasks

## Completion Notes

(To be filled by dev agent upon completion)

## Change Log

- 2025-09-30: Story created (Draft)
